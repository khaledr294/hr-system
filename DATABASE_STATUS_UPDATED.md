# ุชูุฑูุฑ ุญุงูุฉ ุงููุธุงู - ูุญุฏูุซ ุจูุงุกู ุนูู ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุชุงุฑูุฎ:** 15 ููููุจุฑ 2025  
**ุขุฎุฑ ุชุญุฏูุซ:** ุจุนุฏ ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ

---

## โ ุงููุชุงุฆุฌ ุงููููุฉ

### 1. **ุงููุณุชุฎุฏููู ุงูุญุงูููู (6 ูุณุชุฎุฏููู)**

**โจ ุฎุจุฑ ุณุงุฑ: ูุง ููุฌุฏ ุญุณุงุจุงุช ุชุฌุฑูุจูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช!**

ุงููุงุนุฏุฉ ุงูุญุงููุฉ ุชุญุชูู ููุท ุนูู ุงููุณุชุฎุฏููู ุงูุญูููููู:

| # | ุงูุงุณู | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ุงููุณูู ุงููุธููู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |
|---|-------|-------------------|----------------|---------------|
| 1 | ูุงุฏุฑ ุนูู | nader@saed-hr.com | ูุฏูุฑ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ (HR_MANAGER) | ูกูฅโ/ูฉโ/ูขููขูฅ |
| 2 | ุฎุฒุงูู | KHUZAMA@SAID-MR.COM | ูุณูู (MARKETER) | ูกูกโ/ูกูกโ/ูขููขูฅ |
| 3 | ุญุตู ูุญูุฏ | HISSA@saed-MR.com | ูุณูู (MARKETER) | ูกูกโ/ูกูกโ/ูขููขูฅ |
| 4 | ููุงุก | WALAA@saed-MR.com | ูุณูู (MARKETER) | ูกูขโ/ูกูกโ/ูขููขูฅ |
| 5 | ููุฏ | hend@saed-mr.com | ูุณูู (MARKETER) | ูกูขโ/ูกูกโ/ูขููขูฅ |
| 6 | ุดููุงุก | shimaa@saed-hr.com | ูุณูู (MARKETER) | ูกูขโ/ูกูกโ/ูขููขูฅ |

**ููุงุญุธุฉ:** ุฌููุน ุงููุณุชุฎุฏููู ูุฏููู `jobTitleId` ูุญุฏุฏ โ

---

### 2. **ูุธุงู ุงูุตูุงุญูุงุช ุงูุญุงูู (JobTitle-based RBAC)**

#### **ุงูุจููุฉ ุงููุนูุงุฑูุฉ:**
```
User (ุงููุณุชุฎุฏู)
  โโโ jobTitleId (ุฑุจุท ุจุงููุณูู ุงููุธููู)
        โโโ JobTitle (ุงููุณูู ุงููุธููู)
              โโโ permissions: Permission[] (44 ุตูุงุญูุฉ)
              โโโ requiresTwoFactor: Boolean (2FA ูุทููุจุ)
              โโโ name, nameAr, description
```

#### **ุงููุณููุงุช ุงููุธูููุฉ ุงููุญุฏุฏุฉ ูู Seed:**

1. **HR Manager (ูุฏูุฑ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ)**
   - ุงูุตูุงุญูุงุช: **ุฌููุน ุงูุตูุงุญูุงุช** (44 permission)
   - 2FA: ุบูุฑ ูุทููุจ
   - ุงููุตู: ุฅุฏุงุฑุฉ ุงูุนูููุงุช ูุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุฌููุน ุตูุงุญูุงุช ุงููุธุงู

2. **General Manager (ุงููุฏูุฑ ุงูุนุงู)**
   - ุงูุตูุงุญูุงุช: **ูุญุฏูุฏุฉ** (16 permission)
   - ุตูุงุญูุงุช ุงูุนุฑุถ ููุท + ุงูุชูุงุฑูุฑ + ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
   - 2FA: ุบูุฑ ูุทููุจ
   - ุงููุตู: ูุชุงุจุนุฉ ุงูุฃุฏุงุก ูุงูุชูุงุฑูุฑ ุจุฏูู ุชุนุฏูู ุจูุงูุงุช ุญุณุงุณุฉ

3. **Marketer (ูุณูู)**
   - ุงูุตูุงุญูุงุช: **ูุญุฏูุฏุฉ** (9 permissions)
   - ุฅุฏุงุฑุฉ ุงูุนููุงุก ูุงูุนููุฏ + ุญุฌุฒ ุงูุนูุงู + ุงูุจุญุซ
   - 2FA: ุบูุฑ ูุทููุจ
   - ุงููุตู: ุฅุฏุงุฑุฉ ุงูุนููุงุก ูุงูุนููุฏ ุฏูู ุงููุตูู ููุจูุงูุงุช ุงูุญุณุงุณุฉ

#### **ุงูุตูุงุญูุงุช ุงููุชุงุญุฉ (44 permission):**
```typescript
VIEW_WORKERS, CREATE_WORKERS, EDIT_WORKERS, DELETE_WORKERS, RESERVE_WORKERS,
VIEW_CONTRACTS, CREATE_CONTRACTS, EDIT_CONTRACTS, DELETE_CONTRACTS,
VIEW_CLIENTS, CREATE_CLIENTS, EDIT_CLIENTS, DELETE_CLIENTS,
VIEW_USERS, CREATE_USERS, EDIT_USERS, DELETE_USERS,
VIEW_REPORTS, MANAGE_REPORTS, EXPORT_DATA, VIEW_LOGS,
MANAGE_SETTINGS, MANAGE_JOB_TITLES,
VIEW_PAYROLL, MANAGE_PAYROLL,
VIEW_PAYROLL_DELIVERY, MANAGE_PAYROLL_DELIVERY,
VIEW_BACKUPS, MANAGE_BACKUPS,
VIEW_ARCHIVE, MANAGE_ARCHIVE,
MANAGE_TEMPLATES, VIEW_PERFORMANCE, VIEW_SEARCH, MANAGE_PACKAGES
```

---

### 3. **ุงููุดููุฉ: Migration ูู ููุทุจูู ุจุนุฏ**

#### **ุงูุฎุทุฃ ุงูุญุงูู:**
```
malformed array literal: "[\"VIEW_WORKERS\",...]"
"[" must introduce explicitly-specified array dimensions.
```

**ุงูุณุจุจ:**
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ: `JobTitle.permissions` โ **JSON string**
- Schema.prisma ุงูุฌุฏูุฏ: `JobTitle.permissions` โ **Permission[] enum array**
- Migration `20251115152000_permission_overhaul` ูู ููุทุจูู

#### **ุงููุทููุจ:**
ุชุทุจูู Migration ุงูุฐู ูููู ุจู:
1. ุฅูุดุงุก enum `Permission` (44 ูููุฉ)
2. ุฅุถุงูุฉ ุนููุฏ `JobTitle.requiresTwoFactor`
3. ุชุญููู `permissions` ูู JSON ุฅูู enum array
4. ุญุฐู ุนููุฏ `User.role` (ูู ูุนุฏ ูุณุชุฎุฏูุงู)

---

### 4. **ุตูุญุฉ Setup - ูุง ููุ**

**ุงููููุน:** `src/app/setup/page.tsx`

**ุงูุบุฑุถ:** ุตูุญุฉ ููุฑุฉ ูุงุญุฏุฉ ูุฅูุดุงุก ุงููุณุชุฎุฏููู ุงูุงูุชุฑุงุถููู (admin@hr-system, hr@hr-system)

**ุงููุญุชูู:**
- ุฑุณุงูุฉ ุฎุทุฃ 404
- ุฒุฑ ูุคุฏู ุฅูู `/api/setup` ูุฅูุดุงุก ุงูุญุณุงุจุงุช ุงูุชุฌุฑูุจูุฉ
- ุนุฑุถ ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ (admin@hr-system / 123456)

**ุงูุญูู:**
- โ **ูุฌุจ ุญุฐููุง** - ูุฃููุง ุชููุดุฆ ุญุณุงุจุงุช ุชุฌุฑูุจูุฉ ุบูุฑ ูุฑุบูุจุฉ
- โ `/api/setup` route ูุฌุจ ุญุฐูู ุฃูุถุงู
- โ ุงููุณุชุฎุฏููู ุงูุญูููููู ููุฌูุฏูู ุจุงููุนู

---

## ๐ฏ ุฎุทุฉ ุงูุนูู ุงููุญุฏูุซุฉ

### **ุงููุฑุญูุฉ 1: ุชุทุจูู Migration (ุฃููููุฉ ูุตูู)**

#### **ุงูุฎุทูุงุช:**
```powershell
# 1. ูุณุฎ ุงุญุชูุงุทู (ุงุฎุชูุงุฑู - ููุทูุฃูููุฉ)
npx prisma db pull --force

# 2. ุชุทุจูู ุงููุฑุญูุฉ ุงูุฃููู ูู Migration
npx prisma migrate deploy

# 3. ุงูุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ
npm run db:seed
```

#### **ุงูุฃูุงู:**
- โ Migration ุขูู: ูุณุชุฎุฏู `DO $$ BEGIN ... END $$` ููุชุญูู ูุจู ุงูุชูููุฐ
- โ ูุญูู ุงูุจูุงูุงุช ุชููุงุฆูุงู ูู JSON ุฅูู enum
- โ ุฌููุน ุงููุณุชุฎุฏููู ูุฏููู `jobTitleId` (ุชู ุงูุชุญูู)
- โ ูู ูููุฏ ุฃู ูุณุชุฎุฏู ุฃู ุจูุงูุงุช

---

### **ุงููุฑุญูุฉ 2: ุญุฐู ุงูุญุณุงุจุงุช ุงูุชุฌุฑูุจูุฉ ูู ุงูููุฏ**

#### **ุงููููุงุช ุงููุทููุจ ุชุนุฏูููุง:**

##### **1. Seeds & Scripts**
- โ `prisma/seed.ts`: ุญุฐู `ensurePrivilegedUser` ูู admin/hr
- โ `scripts/create-default-users.ts`: ุญุฐู ุงูููู ุจุงููุงูู

##### **2. API Routes**
- โ `src/app/api/setup/route.ts`: ุญุฐู ุงูููู
- โ `src/app/api/setup/create-users/route.ts`: ุญุฐู ุงูููู

##### **3. UI Pages**
- โ `src/app/setup/page.tsx`: ุญุฐู ุงูุตูุญุฉ
- โ๏ธ `src/app/auth/login/page.tsx`: ุฅุฒุงูุฉ `defaultValue="admin"`

##### **4. Documentation**
- โ๏ธ `LOGIN_CREDENTIALS.md`: ุชุญุฏูุซ ุจูุงูุงุช ุงููุณุชุฎุฏููู ุงูุญูููููู
- โ๏ธ ูููุงุช ุงูุชูุซูู ุงูุฃุฎุฑู: ุฅุฒุงูุฉ ุงูุฅุดุงุฑุงุช ููุญุณุงุจุงุช ุงูุชุฌุฑูุจูุฉ

---

### **ุงููุฑุญูุฉ 3: ุชุญุฏูุซ Seed ูููุณุชุฎุฏููู ุงูุญูููููู**

**ุงูุฎูุงุฑ A (ุงูููุตู ุจู):** ุฅุฒุงูุฉ ุฅูุดุงุก ุงููุณุชุฎุฏููู ูู seed ุชูุงูุงู
- ุงูุณุจุจ: ุงููุณุชุฎุฏููู ููุฌูุฏูู ุจุงููุนู
- seed ูุจูู ููุท ูู JobTitles + NationalitySalaries

**ุงูุฎูุงุฑ B:** ุชุญุฏูุซ seed ููุทุงุจูุฉ ุงููุณุชุฎุฏููู ุงูุญูููููู
- ุงุณุชุจุฏุงู admin/hr ุจู nader/shimaa
- ุฅุถุงูุฉ ุจุงูู ุงููุณุชุฎุฏููู (khuzama, hissa, walaa, hend)

---

## โ๏ธ ููุงุท ูุงูุฉ

### **ุงูุฃูุงู:**
1. โ **ุงููุณุชุฎุฏููู ุงูุญูููููู ุขูููู** - ูู ููุญุฐู ุฃู ููุบููุฑ ุฃู ุดูุก
2. โ **Migration ุขูู** - ูุชุญูู ูู ุงููุถุน ุงูุญุงูู ูุจู ุงูุชูููุฐ
3. โ๏ธ **ุชุฃูุฏ ูู backup ูุจู ุฃู ุนูููุฉ**

### **ุงูุตูุงุญูุงุช:**
1. โ๏ธ `nader@saed-hr.com` ูุฏูู ุฏูุฑ `HR_MANAGER` - ุตูุงุญูุงุช ูุงููุฉ โ
2. โ๏ธ ุจุงูู ุงููุณุชุฎุฏููู ูุฏููู ุฏูุฑ `MARKETER` - ุตูุงุญูุงุช ูุญุฏูุฏุฉ
3. ๐ก **ูู ุชุฑูุฏ ุชุนุฏูู ุตูุงุญูุงุช shimaa ุฃู ุฃู ูุณุชุฎุฏู ุขุฎุฑุ**

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ - ุชุฃููุฏ ูุทููุจ

ูุจู ุงููุชุงุจุนุฉุ ุฃุญุชุงุฌ ุชุฃููุฏู ุนูู:

### **1. ุงูุตูุงุญูุงุช:**
- ูู `shimaa@saed-hr.com` ูุฌุจ ุฃู ูููู HR Manager ุฃูุถุงูุ
- ูู ุงููุณูููู (khuzama, hissa, walaa, hend) ุงูุตูุงุญูุงุช ุงูุญุงููุฉ ูุงููุฉุ

### **2. ุฎุทุฉ Migration:**
- ูู ุฃุจุฏุฃ ุจุชุทุจูู `prisma migrate deploy` ุงูุขูุ
- ูู ุชุฑูุฏ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุฃููุงูุ

### **3. ุงูุญุณุงุจุงุช ุงูุชุฌุฑูุจูุฉ:**
- ูู ุฃุญุฐู ูู ูุง ูุชุนูู ุจู admin@hr-system ู hr@hr-system ูู ุงูููุฏุ
- ูู ุฃุญุฐู ุตูุญุฉ `/setup` ู `/api/setup`ุ

### **4. ุชุญุฏูุซ Seed:**
- ุงูุฎูุงุฑ A: ุฅุฒุงูุฉ ุฅูุดุงุก ุงููุณุชุฎุฏููู ุชูุงูุงู (ููุตู ุจู)
- ุงูุฎูุงุฑ B: ุชุญุฏูุซ seed ููุทุงุจูุฉ ุงููุณุชุฎุฏููู ุงูุญูููููู

**ุฃุฎุจุฑูู ุจุงูุฎูุงุฑุงุช ุงูููุถูุฉ ูุณุฃุจุฏุฃ ุงูุชูููุฐ ูุจุงุดุฑุฉ! ๐**
